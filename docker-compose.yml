# Use for testing
version: "2.0"

services:
  sink:
    build: .

  relay:
    build: .
    command: "@@sink:514"
    ports:
      - "514:514/tcp"
    volumes:
      - "logs:/logs:ro"
    depends_on:
      - sink

  source:
    image: alpine
    command: /bin/sh -c 'mkdir -p /logs && echo "File Output" >> /logs/test.log'
    volumes:
      - "logs:/logs"
    restart: always
    depends_on:
      - relay

  logger:
    image: alpine
    command: echo "Network Output" | nc relay 514
    restart: always
    depends_on:
      - relay

volumes:
  logs: